<%
  # Define columns for the failed inspections table
  columns = [
    {
      label: "Phase",
      width: "10%",
      cell: ->(insp) { phase_badge(insp['phase_atual']) }
    },
    {
      label: "Casa",
      width: "10%",
      cell: ->(insp) { content_tag(:strong, insp['job_id']) }
    },
    {
      label: "Processo",
      width: "30%",
      cell: ->(insp) { insp['processo_inspecao']&.truncate(35) || '-' }
    },
    {
      label: "Reprovação",
      width: "15%",
      cell: ->(insp) { content_tag(:span, format_datetime_short(insp['data_reprovacao']), class: "text-muted") }
    },
    {
      label: "Dias Aberto",
      width: "12%",
      cell: ->(insp) { dias_aberto_badge(insp['dias_em_aberto']) }
    },
    {
      label: "Último Status",
      width: "23%",
      cell: ->(insp) { content_tag(:span, insp['ultimo_status']&.truncate(25) || '-', class: "text-muted") }
    }
  ]
%>

<%= render "construction_overview/data_table",
           title: "Inspeções Detalhadas",
           rows: inspections,
           columns: columns,
           entity_name: "inspeção",
           turbo_frame_id: "failed_inspections_table",
           selected_filter: selected_phase,
           clear_filter_path: construction_overview_index_path,
           max_height: "600px",
           empty_message: "Nenhuma inspeção reprovada encontrada.",
           header_class: "text-danger" %>
