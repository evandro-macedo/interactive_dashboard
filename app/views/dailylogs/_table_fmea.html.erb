<% if dailylogs_fmea.any? %>
  <div class="card shadow mb-4">
    <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
      <h6 class="m-0 font-weight-bold text-primary">
        FMEA Records
      </h6>
      <div class="text-muted">
        Showing <strong><%= @fmea_offset + 1 %></strong> to
        <strong><%= @fmea_offset + dailylogs_fmea.length %></strong> records
        <% if @has_more_fmea %>
          <span class="badge bg-info ms-2">More available</span>
        <% end %>
      </div>
    </div>
    <div class="card-body">
      <div class="table-responsive" data-table-scroll-target="container">
        <table class="table table-bordered table-fixed-layout" cellspacing="0">
          <thead>
            <tr>
              <% DailylogsController::FMEA_VISIBLE_COLUMNS.each do |column| %>
                <th class="table-cell-nowrap">
                  <% if DailylogsController::FMEA_SORTABLE_COLUMNS.include?(column) %>
                    <%= sortable_fmea_column(column) %>
                  <% else %>
                    <%= column.titleize %>
                  <% end %>
                </th>
              <% end %>
            </tr>
          </thead>
          <tbody id="dailylogs_fmea_results">
            <%= render "table_rows_fmea", dailylogs_fmea: dailylogs_fmea %>
          </tbody>
        </table>
      </div>

      <!-- Load More Button -->
      <% if @has_more_fmea %>
        <div id="load_more_fmea_container" class="d-flex justify-content-center mt-3">
          <%= link_to dailylogs_path(
                        fmea_filters: params[:fmea_filters],
                        fmea_offset: @fmea_offset + @per_page,
                        fmea_sort: params[:fmea_sort],
                        fmea_direction: params[:fmea_direction]
                      ),
                      class: "btn btn-primary btn-lg",
                      data: {
                        turbo_frame: "dailylogs_fmea_table",
                        turbo_action: "advance"
                      } do %>
            <i class="fas fa-arrow-down me-2"></i>
            Load More (<%= @per_page %> records)
          <% end %>
        </div>
      <% else %>
        <div class="text-center text-muted mt-3">
          <i class="fas fa-check-circle"></i>
          End of results
        </div>
      <% end %>
    </div>
  </div>
<% else %>
  <div class="card shadow mb-4">
    <div class="card-body">
      <div class="alert alert-warning mb-0" role="alert">
        <i class="fas fa-exclamation-triangle"></i>
        No FMEA records found
        <% if params[:fmea_q].present? || @active_fmea_filters.present? %>
          matching your filters
        <% end %>
      </div>
    </div>
  </div>
<% end %>
